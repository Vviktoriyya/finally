<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link href="./output.css" rel="stylesheet">

    <link href="https://fonts.googleapis.com/css2?family=Unica+One&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;500&display=swap" rel="stylesheet">
    <style>
        html, body {
            overflow: scroll; /* Дозволяє прокручування */
            scrollbar-width: none; /* Для Firefox - ховає скролл бар */
        }

        ::-webkit-scrollbar {
            display: none; /* Для Chrome, Safari та Edge - ховає скролл бар */
        }


    </style>
</head>

<body>

<div class="w-full mx-auto pt-[60px] px-[20px] sm:px-[50px] md:px-[50px] lg:px-[110px] xxl:px-[170px]">
    <div class="header flex justify-between  ">
        <div class="logo flex justify-between items-center gap-[12px] ">
            <img src="./icon/BookLogoOpen.png" class="w-[26px] h-[22px]">
            <p class="font-unica text-[20px]">BOOKStore</p>
        </div>
        <div class="buttons flex gap-[20px]">
            <button id="openSavedModal" >
                <img src="./icon/SaveChoose.png" class="w-[16px] h-[23px] ">
            </button>
            <button>
                <img src="./icon/SHOPPINGCART.png" class="w-[27px] h-[24px]">
            </button>
        </div>
    </div>

    <!-- Бокова модалка справа -->
    <div id="modal-container"></div>

    <div class="flex flex-col xl:flex-row justify-between gap-[100px] lg:gap-[150px] px-[20px] xxl:px-[200px] xl:px-[150px] pt-[100px] lg:pt-[110px] lg:items-center">
        <div class="w-full lg:w-[280px] h-[417px] pt-[22px]">
            <div class="book border-2  rounded-[10px] bg-gray-300 flex-shrink-0 shadow-lg sm:h-full xs:h-[380px] sm:w-[280px] xs:w-[250px] overflow-hidden mx-auto">
                <img id="book-img" alt="Book cover" class=" w-full h-full rounded-[10px]" />
            </div>
        </div>


        <div class="infoBook w-full">
            <div class="w-full  flex sm:justify-between xs:justify-center items-center flex-wrap gap-2">
                <p id="book-title" class="font-unica text-[36px] font-[400] text-gray"></p>
                <button id="myButton" class="flex justify-center items-center border-2 rounded-[20px] border-gray w-[57px] yellow-bg bg-white hover:bg-yellow h-[46px]">
                    <img src="./icon/SaveChoose.png" class="w-[13px] h-[18px]">
                </button>

            </div>

            <div class="relative w-full pt-[19px] flex items-center h-[66px]">
                <div class="absolute left-0 right-0 bg-lightGray bottom-[-17px] h-[64px] rounded-[20px] z-[-1]"></div>
                <div id="book-author" class="text-gray relative right-[9px] bg-white font-syne h-[64px] border-[2px] border-dashed border-gray-300 px-[20px] py-[13px] rounded-[20px] text-[14px] w-full">
                </div>
            </div>

            <div class="h-[30px]"></div>
            <div class="relative w-full max-h-[165px]">
                <div class="absolute left-0 right-0 bg-lightGray bottom-[-8px] h-[165px] rounded-[20px] z-[-1]"></div>
                <div id="book-description" class="text-gray relative right-[9px] bg-white font-syne h-[165px] border-[2px] border-dashed border-gray-300 px-[20px] py-[13px] rounded-[20px] text-[14px] w-full overflow-y-auto scrollbar-none">
                    <!-- Опис книги з'явиться тут -->
                </div>
            </div>

            <div class="pt-[30px] lg:pt-[50px] w-full flex justify-between flex-wrap gap-4 items-center">
                <div class="text-Orange text-[28px] lg:text-[36px] font-[400] font-syne leading-[1.2]" id="book-price">
                    <!-- Тут буде ціна -->
                </div>
                <div class="flex w-[104px] h-[35px] gap-[12px]">
                    <button>
                        <img src="./icon/MINUS_CIRCLE.png" class="w-[16px] h-[16px]">
                    </button>
                    <div class="flex justify-center items-center w-[52px] h-[35px] border-2 rounded-[10px] border-gray text-[20px] font-syne font-[400] text-gray">01</div>
                    <button>
                        <img src="./icon/PLUS_CIRCLE.png" class="w-[16px] h-[16px]">
                    </button>
                </div>
            </div>

            <div class="pt-[23px] flex flex-col sm:flex-row justify-between items-center gap-[16px]">
                <a href="" class="relative w-full sm:w-1/2 justify-center items-center h-[46px] flex border-[2px] bg-yellow rounded-[20px] border-gray">
                    <img src="./icon/SHOPPINGCART.png" class="w-[26px] h-[25px]">
                </a>
                <a href="" class="relative w-full sm:w-1/2 justify-center items-center h-[46px] flex border-[2px] bg-orange-500 rounded-[20px] border-gray">
                    <p class="text-gray font-syne text-[20px] font-[400]">Buy Now</p>
                </a>
            </div>
        </div>
    </div>


    <div class="pt-[162px]">
        <div class="flex gap-[12px] justify-start items-center">
            <img src="./icon/Path%20(2).png" class="w-[26px] h-[21px]">
            <p class="text-[36px] font-[400] text-gray font-unica leading-[1.2]">View More</p>
        </div>
    </div>

    <div class="flex justify-center items-center pt-[162px] ">
        <div id="booksGenre" class="w-full h-[410px] border-2 border-dashed overflow-x-auto border-gray-400 rounded-[20px] px-4 flex justify-around items-center">
            <div class="flex min-w-max gap-[100px]">
                <div class="border-2 rounded-[10px] bg-gray-300 w-[187px] h-[279px] flex-shrink-0 shadow-myshadow"></div>
                <div class="border-2 rounded-[10px] bg-gray-300 w-[187px] h-[279px] flex-shrink-0 shadow-myshadow"></div>
                <div class="border-2 rounded-[10px] bg-gray-300 w-[187px] h-[279px] flex-shrink-0 shadow-myshadow"></div>
                <div class="border-2 rounded-[10px] bg-gray-300 w-[187px] h-[279px] flex-shrink-0 shadow-myshadow"></div>
                <div class="border-2 rounded-[10px] bg-gray-300 w-[187px] h-[279px] flex-shrink-0 shadow-myshadow"></div>
            </div>
        </div>
    </div>



    <section class="pt-[220px] w-full">
        <div>

            <div class="w-full border-b-2 border-dashed border-lightGray"></div>

            <div class="pt-[44px] flex md:justify-between items-center gap-[24px] justify-center pb-[100px] flex-col sm:flex-row  sm:items-center">
                <p class="text-[20px] font-syne font-[400] text-lightGray leading-[1.2] mb-4 sm:mb-0">BookStore Project</p>
                <div class="flex gap-[24px]  flex-row items-start">
                    <a href="https://www.linkedin.com/in/%D0%B2%D1%96%D0%BA%D1%82%D0%BE%D1%80%D1%96%D1%8F-%D1%82%D0%BE%D0%BB%D1%81%D1%82%D0%B0%D1%8F-11038a356/" class="relative block w-[48px] h-[48px]">
                        <div class="flex justify-center items-center w-[48px] h-[48px] border-2 border-lightGray rounded-[100px] z-10 bg-white">
                            <img src="./icon/LINKEDINLOGO.png" class="w-[23px] h-[23px] ">
                        </div>
                        <div class="absolute top-[5px] left-[4px] w-[48px] h-[48px] bg-sky-500 rounded-[100px] -z-10"></div>
                    </a>

                    <a href="https://github.com/Vviktoriyya" class="relative block w-[48px] h-[48px]">
                        <div class="flex justify-center items-center w-[48px] h-[48px] border-2 border-lightGray rounded-[100px] z-10 bg-white">
                            <img src="./icon/GITHUBLOGO.png" class="w-[22px] h-[25px] ">
                        </div>
                        <div class="absolute top-[5px] left-[4px] w-[48px] h-[48px] bg-sky-500 rounded-[100px] -z-10"></div>
                    </a>

                    <a href="https://www.figma.com/design/8GbCwAfp9NLq1zWIAgZPpo/BookStore--Short-Project---Community-?node-id=63-2407&p=f&t=KYnPaKQ8ZJHXLu4e-0" class="relative block w-[48px] h-[48px]">
                        <div class="flex justify-center items-center w-[48px] h-[48px] border-2 border-lightGray rounded-[100px] z-10 bg-white">
                            <img src="./icon/FIGMALOGO.png" class="w-[17px] h-[26px] ">
                        </div>
                        <div class="absolute top-[5px] left-[4px] w-[48px] h-[48px] bg-sky-500 rounded-[100px] -z-10"></div>
                    </a>
                </div>
                <p class="text-[20px] font-syne font-[400] text-lightGray leading-[1.2] mt-4 sm:mt-0">by viktoriya tolstaya</p>
            </div>
        </div>

    </section>


</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const params = new URLSearchParams(window.location.search);
        const img = params.get('img');
        const title = params.get('title');
        const author = params.get('author');
        const description = params.get('description');
        const price = params.get('price');

        document.getElementById('book-img').src = img;
        document.getElementById('book-title').textContent = title;
        document.getElementById('book-author').textContent = author;
        document.getElementById('book-description').textContent = description;
        document.getElementById('book-price').textContent = price || '$0.00';
    });

    // Динамічно підключаємо модалку
    fetch('./modal.html')
        .then(response => response.text())
        .then(html => {
            document.getElementById('modal-container').innerHTML = html;
            initializeModal(); // ініціалізація функцій для відкриття та закриття модалки
        });

    function initializeModal() {
        const openSavedModalButton = document.getElementById('openSavedModal');
        const savedModal = document.getElementById('savedModal');
        const closeModalButton = document.getElementById('closeModal');
        const savedBooksList = document.getElementById('savedBooksList');

        openSavedModalButton.addEventListener('click', () => {
            savedModal.classList.remove('hidden');
        });

        closeModalButton.addEventListener('click', () => {
            savedModal.classList.add('hidden');
        });

        // Завантаження списку книг з localStorage
        loadSavedBooks();

        // Додавання нової книги
        const saveButton = document.querySelector('.infoBook button');
        saveButton.addEventListener('click', () => {
            const bookImg = document.getElementById('book-img').src;
            const bookTitle = document.getElementById('book-title').innerText;
            const bookAuthor = document.getElementById('book-author').innerText;
            const bookPrice = document.getElementById('book-price').innerText;

            const bookData = {
                img: bookImg,
                title: bookTitle,
                author: bookAuthor,
                price: bookPrice,
                quantity: 1 // додаємо кількість книги
            };

            // Перевірка на вже існуючу книгу в localStorage
            let savedBooks = JSON.parse(localStorage.getItem('savedBooks')) || [];

            // Перевіряємо чи є така книга в списку
            const existingBook = savedBooks.find(book => book.title === bookTitle);

            if (existingBook) {
                // Якщо книга вже є в списку, збільшуємо кількість
                existingBook.quantity++;
            } else {
                // Якщо книги немає в списку, додаємо нову
                savedBooks.push(bookData);
            }

            // Збереження оновленого списку книг в localStorage
            localStorage.setItem('savedBooks', JSON.stringify(savedBooks));

            // Оновлення списку в модалці після додавання
            loadSavedBooks();
        });
    }

    function loadSavedBooks() {
        const savedBooksList = document.getElementById('savedBooksList');
        const savedBooks = JSON.parse(localStorage.getItem('savedBooks')) || [];

        // Очищаємо список перед оновленням
        savedBooksList.innerHTML = '';

        if (savedBooks.length === 0) {
            savedBooksList.innerHTML = '<p>Список порожній</p>';
        } else {
            savedBooks.forEach(book => {
                const bookElement = document.createElement('div');
                bookElement.classList.add('flex', 'gap-[20px]', 'p-[10px]', 'mb-2');

                bookElement.innerHTML = `
<div class="border-gray pb-[40px] flex lg:p-[26px] xs:p-[10px] border-2 border-dashed rounded-[20px] lg:w-[416px] xs:w-[300px] h-[200px]">
    <div class="book border-2 rounded-[20px] lg:max-w-[103px] lg:h-[150px] xs:h-[114px] xs:max-w-[93px] bg-gray-300">
        <img src="${book.img}" alt="Book cover" class="rounded-[18px] lg:h-full xs:h-[110px] lg:max-w-[100px] xs:max-w-[90px]" />
    </div>
    <div class="flex flex-col">
        <div class="flex lg:gap-[40px] xs:gap-[15px] text-start">
            <div class="flex flex-col lg:gap-[12px] xs:gap-[6px]">
                <p class="flex pl-[31px] text-gray lg:text-[16px] xs:text-[14px] font-[400] leading-[1.2] font-syne">${book.title}</p>
                <p class="flex pl-[31px]  text-gray lg:text-[12px] xs:text-[9px] font-[400] leading-[1.2] font-syne">${book.author}</p>
            </div>
            <div class="text-Orange text-[24px] font-[400] font-syne leading-[1.2]">
                ${book.price}
            </div>
        </div>
        <div class="flex justify-end flex-col h-full lg:pt-[20px] xs:pt-[5px] ">
            <div class="flex justify-between lg:gap-[150px] xs:gap-[60px]">
                <div class="flex relative items-center w-full lg:pl-[31px] xs:pl-[10px] lg:h-[35px] xs:h-[15px] lg:gap-[12px] xs:gap-[7px]">
                    <button class="decreaseQuantity xs:max-w-[15px]">
                        <img src="./icon/MINUS_CIRCLE.png" class="lg:w-[16px] xs:w-[40px] h-[16px]">
                    </button>
                    <div class="flex xs:max-w-[30px] lg:max-w-[80px] leading-[1.2] justify-center items-center w-[52px] lg:h-[35px] xs:h-[25px] border-2 rounded-[10px] border-gray lg:text-[18px] xs:text-[13px] font-syne font-[400] text-gray">
                        ${book.quantity}
                    </div>
                    <button class="increaseQuantity xs:max-w-[15px]">
                        <img src="./icon/PLUS_CIRCLE.png" class="lg:w-[16px] xs:w-[40px] h-[16px]">
                    </button>
                    <button class="flex items-end removeBook lg:pl-[80px] xs:pl-0 ">
                        <img src="./icon/TRASH.png" class="w-[30px] h-[32px]">
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>`;

                // Додавання елементу в список
                savedBooksList.appendChild(bookElement);

                // Додавання функції для видалення книги
                const removeButton = bookElement.querySelector('.removeBook');
                removeButton.addEventListener('click', () => {
                    const index = savedBooks.indexOf(book);
                    if (index > -1) {
                        savedBooks.splice(index, 1);
                        localStorage.setItem('savedBooks', JSON.stringify(savedBooks));
                        loadSavedBooks(); // Оновлюємо список
                    }
                });

                // Додавання функцій для зміни кількості
                const increaseButton = bookElement.querySelector('.increaseQuantity');
                const decreaseButton = bookElement.querySelector('.decreaseQuantity');

                increaseButton.addEventListener('click', () => {
                    book.quantity++;
                    updateBookQuantity(book);
                    loadSavedBooks(); // Оновлюємо список після зміни кількості
                });

                decreaseButton.addEventListener('click', () => {
                    if (book.quantity > 1) {
                        book.quantity--;
                        updateBookQuantity(book);
                        loadSavedBooks(); // Оновлюємо список після зміни кількості
                    }
                });
            });
        }
    }

    function updateBookQuantity(book) {
        let savedBooks = JSON.parse(localStorage.getItem('savedBooks')) || [];
        const bookIndex = savedBooks.findIndex(savedBook => savedBook.title === book.title);
        if (bookIndex > -1) {
            // Перевірка на undefined або null
            if (savedBooks[bookIndex].quantity === undefined || savedBooks[bookIndex].quantity === null) {
                savedBooks[bookIndex].quantity = 1;
            }
            savedBooks[bookIndex].quantity = book.quantity;
            localStorage.setItem('savedBooks', JSON.stringify(savedBooks));
        }
    }

    document.getElementById('myButton').addEventListener('click', function() {
        var button = this;
        // Додаємо клас жовтого фону
        button.classList.add('yellow-bg');

        // Через 3 секунди видаляємо цей клас
        setTimeout(function() {
            button.classList.remove('yellow-bg');
        }, 3000); // 3000 мілісекунд = 3 секунди
    });



</script>


<script src="./app.js"></script>

</body>
</html>